Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='ETTh1_336_336', model='CP_RMCN', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, channel=5, teach=False, resolution='hour', embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_336_CP_RMCN_5_0>>>>>>>>>>>>>>>>>>>>>>>>>>
channel: 5
Total number of parameters: 205418
train 7969
val 2545
test 2545
Epoch: 1 cost time: 5.333283424377441
Epoch: 1, Steps: 62 | Train Loss: 0.8624965 Vali Loss: 1.7870859 Test Loss: 0.5086365
Validation loss decreased (inf --> 1.787086).  Saving model ...
Updating learning rate to 0.0001
Time Elapsed: 7.97 seconds
Epoch: 2 cost time: 5.601093769073486
Epoch: 2, Steps: 62 | Train Loss: 0.6621105 Vali Loss: 2.2062261 Test Loss: 0.3854748
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
Time Elapsed: 15.07 seconds
Epoch: 3 cost time: 5.538865089416504
Epoch: 3, Steps: 62 | Train Loss: 0.2234349 Vali Loss: 0.5782340 Test Loss: 0.1482022
Validation loss decreased (1.787086 --> 0.578234).  Saving model ...
Updating learning rate to 0.0001
Time Elapsed: 22.18 seconds
Epoch: 4 cost time: 5.561121463775635
Epoch: 4, Steps: 62 | Train Loss: 0.0939052 Vali Loss: 0.3026921 Test Loss: 0.1046661
Validation loss decreased (0.578234 --> 0.302692).  Saving model ...
Updating learning rate to 9e-05
Time Elapsed: 29.29 seconds
Epoch: 5 cost time: 4.961108446121216
Epoch: 5, Steps: 62 | Train Loss: 0.0676641 Vali Loss: 0.2087891 Test Loss: 0.0906722
Validation loss decreased (0.302692 --> 0.208789).  Saving model ...
Updating learning rate to 8.1e-05
Time Elapsed: 35.77 seconds
Epoch: 6 cost time: 5.686112880706787
Epoch: 6, Steps: 62 | Train Loss: 0.0571136 Vali Loss: 0.1802384 Test Loss: 0.0848162
Validation loss decreased (0.208789 --> 0.180238).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Time Elapsed: 42.98 seconds
Epoch: 7 cost time: 5.6437060832977295
Epoch: 7, Steps: 62 | Train Loss: 0.0509362 Vali Loss: 0.1598542 Test Loss: 0.0834159
Validation loss decreased (0.180238 --> 0.159854).  Saving model ...
Updating learning rate to 6.561e-05
Time Elapsed: 50.23 seconds
Epoch: 8 cost time: 5.762857913970947
Epoch: 8, Steps: 62 | Train Loss: 0.0470971 Vali Loss: 0.1551128 Test Loss: 0.0844908
Validation loss decreased (0.159854 --> 0.155113).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Time Elapsed: 57.62 seconds
Epoch: 9 cost time: 5.6952431201934814
Epoch: 9, Steps: 62 | Train Loss: 0.0443943 Vali Loss: 0.1492511 Test Loss: 0.0827856
Validation loss decreased (0.155113 --> 0.149251).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Time Elapsed: 64.90 seconds
Epoch: 10 cost time: 4.865315675735474
Epoch: 10, Steps: 62 | Train Loss: 0.0423490 Vali Loss: 0.1480216 Test Loss: 0.0831055
Validation loss decreased (0.149251 --> 0.148022).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Time Elapsed: 71.34 seconds
Epoch: 11 cost time: 5.768401622772217
Epoch: 11, Steps: 62 | Train Loss: 0.0406461 Vali Loss: 0.1463423 Test Loss: 0.0835211
Validation loss decreased (0.148022 --> 0.146342).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Time Elapsed: 78.66 seconds
Epoch: 12 cost time: 5.6773247718811035
Epoch: 12, Steps: 62 | Train Loss: 0.0392760 Vali Loss: 0.1448730 Test Loss: 0.0841463
Validation loss decreased (0.146342 --> 0.144873).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Time Elapsed: 85.91 seconds
Epoch: 13 cost time: 5.69525671005249
Epoch: 13, Steps: 62 | Train Loss: 0.0380754 Vali Loss: 0.1447620 Test Loss: 0.0850472
Validation loss decreased (0.144873 --> 0.144762).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Time Elapsed: 93.13 seconds
Epoch: 14 cost time: 4.860158920288086
Epoch: 14, Steps: 62 | Train Loss: 0.0371181 Vali Loss: 0.1429458 Test Loss: 0.0853584
Validation loss decreased (0.144762 --> 0.142946).  Saving model ...
Updating learning rate to 3.138105960900001e-05
Time Elapsed: 99.64 seconds
Epoch: 15 cost time: 5.763831377029419
Epoch: 15, Steps: 62 | Train Loss: 0.0363031 Vali Loss: 0.1435327 Test Loss: 0.0863574
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
Time Elapsed: 106.88 seconds
Epoch: 16 cost time: 5.771920680999756
Epoch: 16, Steps: 62 | Train Loss: 0.0356012 Vali Loss: 0.1427573 Test Loss: 0.0876019
Validation loss decreased (0.142946 --> 0.142757).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Time Elapsed: 114.25 seconds
Epoch: 17 cost time: 5.669042348861694
Epoch: 17, Steps: 62 | Train Loss: 0.0349598 Vali Loss: 0.1442989 Test Loss: 0.0876538
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
Time Elapsed: 121.45 seconds
Epoch: 18 cost time: 5.671775579452515
Epoch: 18, Steps: 62 | Train Loss: 0.0343958 Vali Loss: 0.1433823 Test Loss: 0.0885235
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.0589113209464907e-05
Time Elapsed: 128.67 seconds
Epoch: 19 cost time: 4.84382438659668
Epoch: 19, Steps: 62 | Train Loss: 0.0339287 Vali Loss: 0.1437687 Test Loss: 0.0889118
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.8530201888518416e-05
Time Elapsed: 135.03 seconds
Epoch: 20 cost time: 5.591224670410156
Epoch: 20, Steps: 62 | Train Loss: 0.0335130 Vali Loss: 0.1435595 Test Loss: 0.0894018
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.6677181699666577e-05
Time Elapsed: 142.10 seconds
Epoch: 21 cost time: 5.668668270111084
Epoch: 21, Steps: 62 | Train Loss: 0.0331355 Vali Loss: 0.1435060 Test Loss: 0.0904350
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_CP_RMCN_5_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.0876019150018692, mae:0.23376698791980743, rse:0.7381687760353088
