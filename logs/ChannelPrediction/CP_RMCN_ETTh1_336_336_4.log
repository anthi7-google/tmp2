Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='ETTh1_336_336', model='CP_RMCN', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, channel=4, teach=False, resolution='hour', embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_336_336_CP_RMCN_4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
channel: 4
Total number of parameters: 205418
train 7969
val 2545
test 2545
Epoch: 1 cost time: 6.025471448898315
Epoch: 1, Steps: 62 | Train Loss: 1.0741733 Vali Loss: 3.2400887 Test Loss: 0.9959071
Validation loss decreased (inf --> 3.240089).  Saving model ...
Updating learning rate to 0.0001
Time Elapsed: 8.69 seconds
Epoch: 2 cost time: 5.546678304672241
Epoch: 2, Steps: 62 | Train Loss: 0.8326893 Vali Loss: 3.3271153 Test Loss: 1.0466204
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
Time Elapsed: 14.96 seconds
Epoch: 3 cost time: 5.481339454650879
Epoch: 3, Steps: 62 | Train Loss: 0.4817956 Vali Loss: 3.3962796 Test Loss: 0.9986320
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0001
Time Elapsed: 21.91 seconds
Epoch: 4 cost time: 5.707742691040039
Epoch: 4, Steps: 62 | Train Loss: 0.3431474 Vali Loss: 3.2026827 Test Loss: 0.6850991
Validation loss decreased (3.240089 --> 3.202683).  Saving model ...
Updating learning rate to 9e-05
Time Elapsed: 29.13 seconds
Epoch: 5 cost time: 5.570057153701782
Epoch: 5, Steps: 62 | Train Loss: 0.2307075 Vali Loss: 3.2010095 Test Loss: 0.4217252
Validation loss decreased (3.202683 --> 3.201010).  Saving model ...
Updating learning rate to 8.1e-05
Time Elapsed: 36.19 seconds
Epoch: 6 cost time: 5.640393972396851
Epoch: 6, Steps: 62 | Train Loss: 0.1666154 Vali Loss: 3.0547135 Test Loss: 0.3388177
Validation loss decreased (3.201010 --> 3.054713).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Time Elapsed: 43.34 seconds
Epoch: 7 cost time: 4.839072227478027
Epoch: 7, Steps: 62 | Train Loss: 0.1357401 Vali Loss: 2.9599187 Test Loss: 0.3028976
Validation loss decreased (3.054713 --> 2.959919).  Saving model ...
Updating learning rate to 6.561e-05
Time Elapsed: 49.71 seconds
Epoch: 8 cost time: 5.700714111328125
Epoch: 8, Steps: 62 | Train Loss: 0.1182163 Vali Loss: 2.8792577 Test Loss: 0.2702958
Validation loss decreased (2.959919 --> 2.879258).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Time Elapsed: 56.91 seconds
Epoch: 9 cost time: 5.621836423873901
Epoch: 9, Steps: 62 | Train Loss: 0.1060293 Vali Loss: 2.7505105 Test Loss: 0.2449276
Validation loss decreased (2.879258 --> 2.750510).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Time Elapsed: 64.05 seconds
Epoch: 10 cost time: 5.59039306640625
Epoch: 10, Steps: 62 | Train Loss: 0.0967017 Vali Loss: 2.7449937 Test Loss: 0.2285684
Validation loss decreased (2.750510 --> 2.744994).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Time Elapsed: 71.19 seconds
Epoch: 11 cost time: 5.6384665966033936
Epoch: 11, Steps: 62 | Train Loss: 0.0892517 Vali Loss: 2.7032125 Test Loss: 0.2140426
Validation loss decreased (2.744994 --> 2.703212).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Time Elapsed: 78.47 seconds
Epoch: 12 cost time: 4.9875242710113525
Epoch: 12, Steps: 62 | Train Loss: 0.0832523 Vali Loss: 2.6818604 Test Loss: 0.2009425
Validation loss decreased (2.703212 --> 2.681860).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Time Elapsed: 85.01 seconds
Epoch: 13 cost time: 5.516616344451904
Epoch: 13, Steps: 62 | Train Loss: 0.0783012 Vali Loss: 2.7191644 Test Loss: 0.1909222
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
Time Elapsed: 91.99 seconds
Epoch: 14 cost time: 5.574340343475342
Epoch: 14, Steps: 62 | Train Loss: 0.0743728 Vali Loss: 2.6285346 Test Loss: 0.1820670
Validation loss decreased (2.681860 --> 2.628535).  Saving model ...
Updating learning rate to 3.138105960900001e-05
Time Elapsed: 99.13 seconds
Epoch: 15 cost time: 5.640677213668823
Epoch: 15, Steps: 62 | Train Loss: 0.0710663 Vali Loss: 2.6661348 Test Loss: 0.1727282
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
Time Elapsed: 106.24 seconds
Epoch: 16 cost time: 4.663913011550903
Epoch: 16, Steps: 62 | Train Loss: 0.0684077 Vali Loss: 2.6736522 Test Loss: 0.1668851
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
Time Elapsed: 112.36 seconds
Epoch: 17 cost time: 5.595277547836304
Epoch: 17, Steps: 62 | Train Loss: 0.0661458 Vali Loss: 2.7013035 Test Loss: 0.1623964
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
Time Elapsed: 119.52 seconds
Epoch: 18 cost time: 5.6200737953186035
Epoch: 18, Steps: 62 | Train Loss: 0.0643133 Vali Loss: 2.7070532 Test Loss: 0.1593899
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
Time Elapsed: 126.63 seconds
Epoch: 19 cost time: 5.63457727432251
Epoch: 19, Steps: 62 | Train Loss: 0.0627837 Vali Loss: 2.6617222 Test Loss: 0.1541344
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_336_336_CP_RMCN_4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.18206697702407837, mae:0.3323999345302582, rse:0.49991342425346375
